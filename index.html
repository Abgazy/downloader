<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JD0NCN0J44"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-JD0NCN0J44');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Saver - تحميل فيديوهات تيك توك بدون علامة مائية</title>
    
    <meta name="google-site-verification" content="8GqG0K_WIDiI63I7Xm39mGqV9W6Gj6o" />
    <meta name="description" content="أفضل أداة مجانية لتحميل فيديوهات تيك توك بدون علامة مائية وبجودة عالية HD.">
    
    <style>
        :root {
            --primary-color: #fe2c55;
            --secondary-color: #25f4ee;
            --bg-light: #f8f9fa;
            --text-dark: #121212;
            --footer-text: #666;
        }

        body.dark-mode {
            --bg-light: #121212;
            --text-dark: #ffffff;
            --footer-text: #bbb;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            margin: 0;
            padding: 0;
            transition: 0.3s;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }

        .header { margin-bottom: 30px; }
        
        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        input[type="text"] {
            flex: 1;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        button {
            padding: 15px 30px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        .ad-container {
            margin: 20px 0;
            min-height: 90px;
            background: #eee;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .footer {
            margin-top: 50px;
            padding: 20px;
            font-size: 14px;
            color: var(--footer-text);
        }

        .footer a { color: var(--primary-color); text-decoration: none; }

        /* تجميل الأزرار بعد التحميل */
        .download-options {
            display: none;
            margin-top: 20px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        body.dark-mode .download-options { background: #1e1e1e; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>TikTok Saver</h1>
        <p>حمّل فيديوهاتك المفضلة بضغطة واحدة</p>
    </div>

    <div class="ad-container">
        <script type="text/javascript">
            atOptions = { 'key' : '98016466f369f635031b26960100f983', 'format' : 'iframe', 'height' : 90, 'width' : 728, 'params' : {} };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/98016466f369f635031b26960100f983/invoke.js"></script>
    </div>

    <div class="input-group">
        <input type="text" id="videoUrl" placeholder="الصق رابط تيك توك هنا...">
        <button onclick="downloadVideo()">تحميل</button>
    </div>

    <div class="ad-container">
        <script type="text/javascript">
            atOptions = { 'key' : 'c20d7575196e792e35928f64243a8536', 'format' : 'iframe', 'height' : 90, 'width' : 728, 'params' : {} };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/c20d7575196e792e35928f64243a8536/invoke.js"></script>
    </div>

    <div id="loading" style="display:none;">جاري المعالجة...</div>

    <div id="result" class="download-options">
        </div>
</div>

<footer class="footer">
    <p>© 2026 TikTok Saver | جميع الحقوق محفوظة</p>
    <p><a href="terms.html">الشروط والأحكام</a></p>
</footer>

<script>
    // نظام الأمان والحد من الطلبات
    let requestCount = 0;
    setInterval(() => { requestCount = 0; }, 60000); // تصفير العداد كل دقيقة

    async function downloadVideo() {
        const url = document.getElementById('videoUrl').value;
        const resultDiv = document.getElementById('result');
        const loading = document.getElementById('loading');

        if (!url.includes('tiktok.com')) {
            alert('يرجى إدخال رابط تيك توك صحيح');
            return;
        }

        if (requestCount >= 5) {
            alert('لقد تجاوزت الحد المسموح (5 طلبات في الدقيقة). انتظر قليلاً.');
            return;
        }

        loading.style.display = 'block';
        resultDiv.style.display = 'none';
        requestCount++;

        try {
            // استخدام الـ Worker الخاص بك
            const response = await fetch(`https://tiktok-proxy.nasralhrby370.workers.dev/?url=${encodeURIComponent(url)}`);
            const data = await response.json();

            if (data.status === 'success') {
                loading.style.display = 'none';
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <h3>${data.title || 'تم العثور على الفيديو'}</h3>
                    <button onclick="window.open('${data.video_no_watermark}')">تحميل بدون علامة (سيرفر 1)</button>
                    <button style="margin-top:10px; background:#25f4ee" onclick="window.location.href='https://www.highperformanceformat.com/v8t6z9e9?key=8e78074d6f4614a9da2533d178e22896'">تحميل جودة HD (رابط سريع)</button>
                `;
            } else {
                throw new Error('فشل الاستخراج');
            }
        } catch (error) {
            loading.style.display = 'none';
            alert('عذراً، حدث خطأ أثناء معالجة الرابط. تأكد من أن الرابط عام وليس خاصاً.');
        }
    }

    // تفعيل الوضع الليلي تلقائياً حسب إعدادات الجهاز
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark-mode');
    }
</script>

</body>
</html>
